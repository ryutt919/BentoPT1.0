# 🏋️‍♂️ Bento PT 1.0 🍱

## 📌 프로젝트 개요  
OpenCV와 Python 기반의 이 시스템은 사용자가 짧은 운동 영상과 운동 종류를 입력하면,  
**실시간 영상 재생**, **관절 키포인트 시각화**, **보조선 출력**을 통해 **운동 자세를 분석하고 피드백**을 제공합니다.

---

## 🔍 주요 기능 및 처리 흐름

### 1. 👤 사람 검출 및 키포인트 추출
- **사용 모델**: `YOLOv8x` (객체 감지), `YOLOv8x-pose` (포즈 추정)
- **작업 내용**:
  - 프레임마다 사람 감지 → 17개 관절 키포인트 추출 `(x, y, confidence)`
  - 다중 인물 영상은 자동 제외
  - 결과는 `.npz` 파일로 저장 (`frame`, `timestamp`, `keypoints` 포함)

---

### 2. 🛠 키포인트 보정 및 필터링
- **필터링 기법**:
  - 🟧 메디안 필터: 이상치 제거  
  - 🟦 가우시안 필터: 부드러운 스무딩  
  - 🟨 1D 칼만 필터: 시계열 노이즈 감소 및 예측 보정  
- **정규화 처리**:  
  - 프레임 해상도에 따라 키포인트 좌표를 `[0, 1]` 범위로 정규화

---

### 3. 🏷 수동 라벨링 도구
- `.npz` + 영상 동기화 → 각 프레임별 운동 라벨 지정 가능
- 키보드 단축키로 `good`, `elbow_not_vertical`, `knee_over_toes` 등 피드백 라벨 부여
- 라벨은 `.csv` 파일로 저장되어 학습용 라벨로 사용됨

---

### 4. 🧮 데이터셋 준비 (MMAction2 호환)
- **COCO 포맷**으로 키포인트 변환  
- **슬라이딩 윈도우** 방식으로 시퀀스 생성 (예: `window_size=8`, `stride=4`)  
- **라벨링된/되지 않은 시퀀스 분리**  
- MMACTION2 학습용 `train.pkl`, `val.pkl`, `unlabeled.pkl` 등으로 저장

---

### 5. 🧠 모델 학습
- **프레임워크**: [MMAction2](https://github.com/open-mmlab/mmaction2)  
- **모델**: ST-GCN (Spatial Temporal Graph Convolutional Network)
- **학습 기능**:
  - AMP 자동 정밀도 설정
  - Checkpoint 저장 및 resume 지원
  - 정확도, 정밀도, F1 등 다양한 평가 지표 제공

---

### 6. 🤖 준지도 학습 (Pseudo Labeling)
- **라벨 없는 시퀀스**에 대해 학습된 모델로 예측 수행
- **신뢰도 기준 이상(≥ 0.8)**인 예측 결과만 가짜 라벨로 추가
- Pseudo-label 데이터까지 포함해 학습 데이터셋 확장 및 성능 향상

---

### 7. 🎥 키포인트 시각화 및 피드백 제공
- **OpenCV** 기반 실시간 키포인트/스켈레톤 오버레이
- 관절 연결선 + 발목-무릎 보조선 포함
- 자동 재생 / 수동 라벨링 / 프레임 탐색 지원

---

## 🧰 사용 기술 스택

| 도구 | 설명 |
|------|------|
| Python 3.x | 전체 프로젝트 구현 |
| OpenCV | 영상 처리 및 키포인트 시각화 |
| YOLOv8 | 사람 검출 및 관절 키포인트 추출 |
| NumPy / SciPy | 필터링 및 수치 연산 |
| pandas | 라벨 CSV 처리 |
| PyTorch / MMAction2 | ST-GCN 모델 학습 및 추론 |
| tqdm | 진행 상황 표시 |
| scikit-learn | 데이터 분할 및 평가 지표 계산 |

---

## ✨ 프로젝트 요약

이 시스템은 **영상 기반 관절 키포인트 추출 → 필터링 → 정규화 → 라벨링 → 시퀀스 생성 → 학습 → 피드백**의 전체 파이프라인을 제공합니다.  
ST-GCN 기반 모델 학습과 **준지도 학습**을 통해 라벨 부족 문제를 보완하며,  
최종적으로 **실시간 운동 자세 평가 및 피드백 제공**이 가능한 **완성도 높은 운동 분석 시스템**을 구현합니다.

---

