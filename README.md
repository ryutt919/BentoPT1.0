# π± Bento PT 1.0 π‹οΈβ€β™‚οΈ

##  ν”„λ΅μ νΈ κ°μ”  
OpenCVμ™€ Python κΈ°λ°μ μ΄ μ‹μ¤ν…μ€ μ‚¬μ©μκ°€ μ§§μ€ μ΄λ™ μμƒκ³Ό μ΄λ™ μΆ…λ¥λ¥Ό μ…λ ¥ν•λ©΄,  
**μ‹¤μ‹κ°„ μμƒ μ¬μƒ**, **κ΄€μ  ν‚¤ν¬μΈνΈ μ‹κ°ν™”**, **λ³΄μ΅°μ„  μ¶λ ¥**μ„ ν†µν•΄ **μ΄λ™ μμ„Έλ¥Ό λ¶„μ„ν•κ³  ν”Όλ“λ°±**μ„ μ κ³µν•©λ‹λ‹¤.

---
## κ°λ° λ™κΈ° λ° λ°°κ²½
μ΄ ν”„λ΅μ νΈλ” λ‹¨μν λμ•„κ°€λ” μ‹μ¤ν…μ„ λ§λ“λ” κ²ƒμ΄ λ©ν‘κ°€ μ•„λ‹μ—μµλ‹λ‹¤.
λ‚λ” μμ—… μ‹κ°„μ— λ°°μ΄ λ‚΄μ©λ“¤μ„ μ‹¤μ  λ¬Έμ  ν•΄κ²°μ— μ μ©ν•κ³ , κΈ°μ΅΄μ— μλ” λ¨λΈμ΄λ‚ μλ™ν™”λ λΌμ΄λΈλ¬λ¦¬μ—λ§ μμ΅΄ν•μ§€ μ•κ³ ,
κ°€λ¥ν• ν• λ¨λ“  κµ¬μ„±μ”μ†λ¥Ό μ§μ ‘ μ„¤κ³„ν•κ³  ν•™μµμ‹ν‚¤λ©° μ»¤μ¤ν„°λ§μ΄μ§•ν•΄λ³΄κ³  μ‹¶μ—μµλ‹λ‹¤.

κ·Έλμ„ μ„ νƒν• λ°©λ²•μ€ μ‰½μ§€ μ•μ•μµλ‹λ‹¤.
μλ§μ€ ν¬μ¦ μ¶”μ • μ¤ν”μ†μ¤μ™€ μ‚¬μ „ν•™μµλ λ¨λΈλ“¤μ΄ λ„μ³λ‚λ” μ‹λ€μ—,
λ‚λ” μ§μ ‘ YOLO κΈ°λ° ν‚¤ν¬μΈνΈ μ¶”μ¶ β†’ ν•„ν„°λ§ β†’ μ •κ·ν™” β†’ λΌλ²¨λ§ β†’ ST-GCN ν•™μµκΉμ§€ λ¨λ“  νμ΄ν”„λΌμΈμ„ μ»¤μ¤ν…€ κµ¬μ¶•ν–μµλ‹λ‹¤.

λ¨λΈ ν•™μµμ„ μ„ν•΄ Kinetics-400 κΈ°λ°μ μ΄λ™ μμƒμ„ μμ§‘ν•κ³ 
λΌλ²¨λ§λ¶€ν„° λ°μ΄ν„° κµ¬μ΅° λ³€ν™, μ‹ν€€μ¤ κµ¬μ„±κΉμ§€ ν•λ‚ν•λ‚ μ§μ ‘ μ„¤κ³„ν•λ©°
νΌμμ„ MMACTION2μ κ΄‘λ€ν• μ½”λ“λ² μ΄μ¤μ™€ λ¬Έμ„ μ†μ„ λμ—†μ΄ ν—¤λ§¤κ³ ,
μμ‹­ λ²μ μ‹ν–‰μ°©μ¤μ™€ μλ§μ€ μ‚½μ§ λμ— κ²°κµ­ λ¨λΈμ„ ν•™μµμ‹μΌλƒμµλ‹λ‹¤.

μ΄ ν”„λ΅μ νΈλ” λ‹¨μ§€ 'μ μ‘λ™ν•λ” ν”„λ΅κ·Έλ¨'μ΄ μ•„λ‹λΌ
"ν•λ‚μ κµ¬μ΅°λ¥Ό μ΄ν•΄ν•κ³  μ¤μ¤λ΅ λΉλ“μ—…ν• κ²½ν—"μ΄λ©°,
μμ—…μ—μ„ λ°°μ΄ μ΄λ΅ μ΄ μ‹¤μ λ΅ μ–΄λ–»κ² κµ¬ν„λκ³  ν™•μ¥λ  μ μλ”μ§€λ¥Ό μ¦λ…ν• κ°μΈμ  μ¦κ±°μ΄μ κΈ°λ΅μ…λ‹λ‹¤.
---

##  μ£Όμ” κΈ°λ¥ λ° μ²λ¦¬ νλ¦„

### 1.  μ‚¬λ κ²€μ¶ λ° ν‚¤ν¬μΈνΈ μ¶”μ¶
- **μ‚¬μ© λ¨λΈ**: `YOLOv8x` (κ°μ²΄ κ°μ§€), `YOLOv8x-pose` (ν¬μ¦ μ¶”μ •)
- **μ‘μ—… λ‚΄μ©**:
  - ν”„λ μ„λ§λ‹¤ μ‚¬λ κ°μ§€ β†’ 17κ° κ΄€μ  ν‚¤ν¬μΈνΈ μ¶”μ¶ `(x, y, confidence)`
  - ν•™μµ λ°μ΄ν„° μ§ ν–¥μƒμ„ μ„ν•΄ λ‹¤μ¤‘ μΈλ¬Ό μμƒμ€ μλ™ μ μ™Έ
  - κ²°κ³Όλ” `.npz` νμΌλ΅ μ €μ¥ (`frame`, `timestamp`, `keypoints` ν¬ν•¨)

---

### 2.  ν‚¤ν¬μΈνΈ λ³΄μ • λ° ν•„ν„°λ§
- **ν•„ν„°λ§ κΈ°λ²•**:
  -  λ©”λ””μ• ν•„ν„°: μ΄μƒμΉ μ κ±°  
  -  κ°€μ°μ‹μ• ν•„ν„°: λ¶€λ“λ¬μ΄ μ¤λ¬΄λ”©  
  -  1D μΉΌλ§ ν•„ν„°: μ‹κ³„μ—΄ λ…Έμ΄μ¦ κ°μ† λ° μμΈ΅ λ³΄μ •  
- **μ •κ·ν™” μ²λ¦¬**:  
  - ν”„λ μ„ ν•΄μƒλ„μ— λ”°λΌ ν‚¤ν¬μΈνΈ μΆν‘λ¥Ό `[0, 1]` λ²”μ„λ΅ μ •κ·ν™”

---

### 3.  μλ™ λΌλ²¨λ§ λ„κµ¬
- `.npz` + μμƒ λ™κΈ°ν™” β†’ μμƒ λ³„λ΅ μΌλ¶€ ν”„λ μ„μ— μ§μ ‘ λΌλ²¨λ§
- ν‚¤λ³΄λ“ λ‹¨μ¶•ν‚¤λ΅ `good`, `elbow_not_vertical`, `knee_over_toes` λ“± ν”Όλ“λ°± λΌλ²¨ λ¶€μ—¬
- λΌλ²¨μ€ `.csv` νμΌλ΅ μ €μ¥λμ–΄ ν•™μµμ© λΌλ²¨λ΅ μ‚¬μ©λ¨

---

### 4.  λ°μ΄ν„°μ…‹ μ¤€λΉ„ (MMAction2 νΈν™)
- **COCO ν¬λ§·**μΌλ΅ ν‚¤ν¬μΈνΈ λ³€ν™  
- **μ¬λΌμ΄λ”© μλ„μ°** λ°©μ‹μΌλ΅ μ‹ν€€μ¤ μƒμ„± (μ: `window_size=8`, `stride=4`)  
- **λΌλ²¨λ§λ/λμ§€ μ•μ€ μ‹ν€€μ¤ λ¶„λ¦¬**  
- MMACTION2 ν•™μµμ© `train.pkl`, `val.pkl`, `unlabeled.pkl` λ“±μΌλ΅ μ €μ¥

---

### 5. π§  λ¨λΈ ν•™μµ
- **ν”„λ μ„μ›ν¬**: [MMAction2](https://github.com/open-mmlab/mmaction2)  
- **λ¨λΈ**: ST-GCN (Spatial Temporal Graph Convolutional Network)
- **νΉμ§•**:
  μ΄λ™ μμ„Έ λ¶„μ„μ€ λ‹¨μν• ν”„λ μ„ κ°„ λ³€ν™”λ§μΌλ΅λ” μ¶©λ¶„ν•μ§€ μ•μΌλ©°,
  μ‚¬λμ **κ΄€μ  κ°„ μ—°κ²° κµ¬μ΅°(κ΄€μ -κ΄€μ  κ΄€κ³„)**μ™€ **μ‹κ°„ μ¶• μ›€μ§μ„(λ™μ‘ νλ¦„)**μ„ λ™μ‹μ— λ°μν•΄μ•Ό ν•©λ‹λ‹¤.

  κΈ°μ΅΄ CNNμ€ ν”½μ…€ κ²©μ κΈ°λ°μ΄κΈ° λ•λ¬Έμ—, κ΄€μ  κ°„μ λ¶κ·μΉ™ν•κ³  λΉ„μ ν΄λ¦¬λ“μ μΈ μ—°κ²° κ΄€κ³„λ¥Ό ν‘ν„ν•κΈ° μ–΄λ µμµλ‹λ‹¤.
  λ”°λΌμ„ λ³Έ ν”„λ΅μ νΈλ” λ‹¤μμ μ΄μ λ΅ ST-GCN (Spatial-Temporal Graph Convolutional Network) λ¨λΈμ„ μ±„νƒν–μµλ‹λ‹¤
  
- **κµ¬μ΅°**
  κµ¬μ„± μ”μ†	μ„¤λ…
  Spatial Graph	κ° ν”„λ μ„μ κ΄€μ μ„ κ·Έλν”„ λ…Έλ“λ΅ κµ¬μ„±ν•κ³ , κ΄€μ  κ°„ ν•΄λ¶€ν•™μ  μ—°κ²°μ— λ”°λΌ μ—£μ§€λ¥Ό κµ¬μ„±
  Temporal Graph	λ™μΌ κ΄€μ μ΄ μ‹κ°„ μ¶•μ„ λ”°λΌ μ΄μ–΄μ§€λ„λ΅ μ—°κ²° β†’ μ›€μ§μ„μ μ—°μ†μ„± λ°μ
  Graph Convolution	CNN λ€μ‹  Graph Convolutionμ„ ν†µν•΄ κ΄€μ  κ°„ κµ¬μ΅°μ μΈ κ΄€κ³„ ν•™μµ
  Joint-Level Attention	νΉμ • κ΄€μ μ μ›€μ§μ„μ΄ μμ„Έ ν‰κ°€μ— μ–Όλ§λ‚ μ¤‘μ”ν•μ§€λ¥Ό ν•™μµν•¨


---

### 6.  μ¤€μ§€λ„ ν•™μµ (Pseudo Labeling)
- **λΌλ²¨ μ—†λ” μ‹ν€€μ¤**μ— λ€ν•΄ ν•™μµλ λ¨λΈλ΅ μμΈ΅ μν–‰
- **μ‹ λΆ°λ„ κΈ°μ¤€ μ΄μƒ(β‰¥ 0.8)**μΈ μμΈ΅ κ²°κ³Όλ§ κ°€μ§ λΌλ²¨λ΅ μ¶”κ°€
- Pseudo-label λ°μ΄ν„°κΉμ§€ ν¬ν•¨ν•΄ ν•™μµ λ°μ΄ν„°μ…‹ ν™•μ¥ λ° μ„±λ¥ ν–¥μƒ
- 
  **ν•™μµ κ²°κ³Ό**
- ν•™μµ λ°μ΄ν„°μ μ§μ  μ°¨μ΄λ΅ μΈν•΄ ν’€μ—…μ΄ λ” μΆ‹μ€ μ„±λ¥μ„ λ³΄μ—¬μ¤
- λ°μ§€μ κ²½μ° window sizeμ™€ strideμ™€ κ°™μ€ νλΌλ―Έν„°λ¥Ό μ΅°μ •ν•μ—¬ μ„±λ¥ ν–¥μƒμ„ λ³΄μ—¬μ¤<br>
  <br>
 
- λ°μ§€
- ![image](https://github.com/user-attachments/assets/45666544-166d-432a-8bb2-597ed9636b7c)
- ![image](https://github.com/user-attachments/assets/c5d4f81e-c834-4ebb-8c96-014f4fcf7302)

- ν’€μ—…
- ![image](https://github.com/user-attachments/assets/9543df6e-479c-485a-b9e3-11194ca070b6)
- ![image](https://github.com/user-attachments/assets/9e661e8f-f3be-47c4-b6fb-fade493d7a2c)

---

### 7.  ν‚¤ν¬μΈνΈ μ‹κ°ν™” λ° ν”Όλ“λ°± μ κ³µ
- GUIλ¥Ό ν†µν• νΈλ¦¬ν• μ‚¬μ© μ κ³µ
- ![image](https://github.com/user-attachments/assets/fc884bbe-7b65-4745-8b33-d6f1a2005cf1)

- **OpenCV** κΈ°λ° μ‹¤μ‹κ°„ ν‚¤ν¬μΈνΈ/μ¤μΌλ ν†¤ μ¤λ²„λ μ΄
- κ΄€μ  μ—°κ²°μ„  + λ°λ©-λ¬΄λ¦ λ³΄μ΅°μ„  ν¬ν•¨
- μ‹¤μ‹κ°„ ν”Όλ“λ°± μ κ³µ
- ![image](https://github.com/user-attachments/assets/ae76982d-cff3-4648-87aa-19268366e8e7)


---

##  μ‚¬μ© κΈ°μ  μ¤νƒ

| λ„κµ¬ | μ„¤λ… |
|------|------|
| Python 3.x | μ „μ²΄ ν”„λ΅μ νΈ κµ¬ν„ |
| OpenCV | μμƒ μ²λ¦¬ λ° ν‚¤ν¬μΈνΈ μ‹κ°ν™” |
| YOLOv8 | μ‚¬λ κ²€μ¶ λ° κ΄€μ  ν‚¤ν¬μΈνΈ μ¶”μ¶ |
| NumPy / SciPy | ν•„ν„°λ§ λ° μμΉ μ—°μ‚° |
| pandas | λΌλ²¨ CSV μ²λ¦¬ |
| PyTorch / MMAction2 | ST-GCN λ¨λΈ ν•™μµ λ° μ¶”λ΅  |
| tqdm | μ§„ν–‰ μƒν™© ν‘μ‹ |
| scikit-learn | λ°μ΄ν„° λ¶„ν•  λ° ν‰κ°€ μ§€ν‘ κ³„μ‚° |

---



